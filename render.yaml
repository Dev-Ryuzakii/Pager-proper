services:
  - type: web
    name: secure-messaging-api
    runtime: python
    buildCommand: "pip install -r requirements_postgresql.txt"
    preDeployCommand: "python init_db.py"
    startCommand: "./start_render.sh"
    envVars:
      - key: PYTHON_VERSION
        value: 3.13.4
      - key: PORT
        value: 8001
  - type: worker
    name: message-cleanup-worker
    runtime: python
    buildCommand: "pip install -r requirements_postgresql.txt"
    startCommand: "python background_cleanup.py"
    envVars:
      - key: PYTHON_VERSION
        value: 3.13.4
      - key: CLEANUP_INTERVAL_SECONDS
        value: "3600"